
<!DOCTYPE html>
<html>
	<head> 
		

















 
	
	
		
	




<script>

/*ControllerUtil.redirectPost alert*/
if("" != ""){
    var msg = "".replace("<br>", "\n");
	alert(msg);
    
}
</script>


	<!-- SET FILE PATH :: compatibility ie9 code -->
        <base href="../" />
        <!--[if IE]><script type="text/javascript">
            // Fix for IE ignoring relative base tags.
            (function() {
                var baseTag = document.getElementsByTagName('base')[0];
                baseTag.href = baseTag.href;
            })();
        </script><![endif]-->
        <meta charset="UTF-8">
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
          
        	
        	
        		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
        	
        
        <meta name="format-detection" content="telephone=no">
	     <meta http-equiv="X-UA-Compatible" content="IE=edge">
         <!-- TITLE -->
         <title>EuDi</title>
	    
		
		
		
		
		
		
		 
		
		


<!--2019-09-16 4M ê¹íë¹-->
<!-- common css file-->

<!-- common css file-->
<link rel="stylesheet" href="/resource/assets/web/css/main.css?20230830061325">
<link rel="stylesheet" href="/resource/assets/web/css/mediaQuery.css?20230830061325">


<!-- nurse css file -->
<link rel="stylesheet" href="/resource/assets/web/nurse/css/common.css?20230830061325">
<link rel="stylesheet" href="/resource/assets/web/nurse/css/sub.css?20230830061325">
<link rel="stylesheet" href="/resource/assets/web/nurse/css/font.css?20230830061325">
<link rel="stylesheet" href="/resource/assets/web/nurse/css/counseling.css?20230830061325">



<!-- nurse js file-->
<script type="text/javascript" src="/resource/assets/web/nurse/js/lib/jquery-1.11.3.min.js?version=1.2"></script>
<script type="text/javascript" src="/resource/assets/web/nurse/js/lib/jquery-ui-1.11.3.min.js?version=1.2"></script>
<script type="text/javascript" src="/resource/assets/web/nurse/js/lib/jquery.easing.1.3.js?version=1.2"></script>
<script type="text/javascript" src="/resource/assets/web/nurse/js/common.js?20230830061325"></script>


	
		<!-- í¼ë¸ ìì¤ overwrite ë°©ì§ë¡ ê°ë°ìì¤ ì´ë¦ ë³ê²½
		<script src="/resource/assets/web/nurse/js/counseling.js"></script>
		-->
		<script src="/resource/assets/web/nurse/js/counseling.dev.js?20230830061325"></script>
	




<!-- common js file-->
<script type="text/javascript" src="/resource/assets/common/js/common.js?version=1.3"></script>
<script type="text/javascript" src="/resource/assets/common/js/jquery.cookie.js?version=1.2"></script>

<!-- ê°ë°ì© css -->
<style>
	.placeholder-err::placeholder{
	  color: red;
	  opacity: 1; /* íì´ì´í­ì¤ìì ë¿ìê² ëì¤ë íìì ë°©ì§íê¸° ìí css */
	}
	.placeholder-err::-webkit-input-placeholder{
	  color: red;
	}
	.placeholder-err:-ms-input-placeholder{
	  color: red;
	}
	.placeholder-err:-mos-input-placeholder {
	  color: red;
	}
</style>

<script type="text/javascript">

      
    function SHA256(s){
      
        var chrsz   = 8;
        var hexcase = 0;
      
        function safe_add (x, y) {
            var lsw = (x & 0xFFFF) + (y & 0xFFFF);
            var msw = (x >> 16) + (y >> 16) + (lsw >> 16);
            return (msw << 16) | (lsw & 0xFFFF);
        }
      
        function S (X, n) { return ( X >>> n ) | (X << (32 - n)); }
        function R (X, n) { return ( X >>> n ); }
        function Ch(x, y, z) { return ((x & y) ^ ((~x) & z)); }
        function Maj(x, y, z) { return ((x & y) ^ (x & z) ^ (y & z)); }
        function Sigma0256(x) { return (S(x, 2) ^ S(x, 13) ^ S(x, 22)); }
        function Sigma1256(x) { return (S(x, 6) ^ S(x, 11) ^ S(x, 25)); }
        function Gamma0256(x) { return (S(x, 7) ^ S(x, 18) ^ R(x, 3)); }
        function Gamma1256(x) { return (S(x, 17) ^ S(x, 19) ^ R(x, 10)); }
      
        function core_sha256 (m, l) {
             
            var K = new Array(0x428A2F98, 0x71374491, 0xB5C0FBCF, 0xE9B5DBA5, 0x3956C25B, 0x59F111F1,
                0x923F82A4, 0xAB1C5ED5, 0xD807AA98, 0x12835B01, 0x243185BE, 0x550C7DC3,
                0x72BE5D74, 0x80DEB1FE, 0x9BDC06A7, 0xC19BF174, 0xE49B69C1, 0xEFBE4786,
                0xFC19DC6, 0x240CA1CC, 0x2DE92C6F, 0x4A7484AA, 0x5CB0A9DC, 0x76F988DA,
                0x983E5152, 0xA831C66D, 0xB00327C8, 0xBF597FC7, 0xC6E00BF3, 0xD5A79147,
                0x6CA6351, 0x14292967, 0x27B70A85, 0x2E1B2138, 0x4D2C6DFC, 0x53380D13,
                0x650A7354, 0x766A0ABB, 0x81C2C92E, 0x92722C85, 0xA2BFE8A1, 0xA81A664B,
                0xC24B8B70, 0xC76C51A3, 0xD192E819, 0xD6990624, 0xF40E3585, 0x106AA070,
                0x19A4C116, 0x1E376C08, 0x2748774C, 0x34B0BCB5, 0x391C0CB3, 0x4ED8AA4A,
                0x5B9CCA4F, 0x682E6FF3, 0x748F82EE, 0x78A5636F, 0x84C87814, 0x8CC70208,
                0x90BEFFFA, 0xA4506CEB, 0xBEF9A3F7, 0xC67178F2);
 
            var HASH = new Array(0x6A09E667, 0xBB67AE85, 0x3C6EF372, 0xA54FF53A, 0x510E527F, 
                       0x9B05688C, 0x1F83D9AB, 0x5BE0CD19);
 
            var W = new Array(64);
            var a, b, c, d, e, f, g, h, i, j;
            var T1, T2;
      
            m[l >> 5] |= 0x80 << (24 - l % 32);
            m[((l + 64 >> 9) << 4) + 15] = l;
      
            for ( var i = 0; i<m.length; i+=16 ) {
                a = HASH[0];
                b = HASH[1];
                c = HASH[2];
                d = HASH[3];
                e = HASH[4];
                f = HASH[5];
                g = HASH[6];
                h = HASH[7];
      
                for ( var j = 0; j<64; j++) {
                    if (j < 16) W[j] = m[j + i];
                    else W[j] = safe_add(safe_add(safe_add(Gamma1256(W[j - 2]), W[j - 7]), Gamma0256(W[j - 15])), W[j - 16]);
      
                    T1 = safe_add(safe_add(safe_add(safe_add(h, Sigma1256(e)), Ch(e, f, g)), K[j]), W[j]);
                    T2 = safe_add(Sigma0256(a), Maj(a, b, c));
      
                    h = g;
                    g = f;
                    f = e;
                    e = safe_add(d, T1);
                    d = c;
                    c = b;
                    b = a;
                    a = safe_add(T1, T2);
                }
      
                HASH[0] = safe_add(a, HASH[0]);
                HASH[1] = safe_add(b, HASH[1]);
                HASH[2] = safe_add(c, HASH[2]);
                HASH[3] = safe_add(d, HASH[3]);
                HASH[4] = safe_add(e, HASH[4]);
                HASH[5] = safe_add(f, HASH[5]);
                HASH[6] = safe_add(g, HASH[6]);
                HASH[7] = safe_add(h, HASH[7]);
            }
            return HASH;
        }
      
        function str2binb (str) {
            var bin = Array();
            var mask = (1 << chrsz) - 1;
            for(var i = 0; i < str.length * chrsz; i += chrsz) {
                bin[i>>5] |= (str.charCodeAt(i / chrsz) & mask) << (24 - i%32);
            }
            return bin;
        }
      
        function Utf8Encode(string) {
            string = string.replace(/\r\n/g,"\n");
            var utftext = "";
      
            for (var n = 0; n < string.length; n++) {
      
                var c = string.charCodeAt(n);
      
                if (c < 128) {
                    utftext += String.fromCharCode(c);
                }
                else if((c > 127) && (c < 2048)) {
                    utftext += String.fromCharCode((c >> 6) | 192);
                    utftext += String.fromCharCode((c & 63) | 128);
                }
                else {
                    utftext += String.fromCharCode((c >> 12) | 224);
                    utftext += String.fromCharCode(((c >> 6) & 63) | 128);
                    utftext += String.fromCharCode((c & 63) | 128);
                }
      
            }
      
            return utftext;
        }
      
        function binb2hex (binarray) {
            var hex_tab = hexcase ? "0123456789ABCDEF" : "0123456789abcdef";
            var str = "";
            for(var i = 0; i < binarray.length * 4; i++) {
                str += hex_tab.charAt((binarray[i>>2] >> ((3 - i%4)*8+4)) & 0xF) +
                hex_tab.charAt((binarray[i>>2] >> ((3 - i%4)*8  )) & 0xF);
            }
            return str;
        }
      
        s = Utf8Encode(s);
        return binb2hex(core_sha256(str2binb(s), s.length * chrsz));
      
    }
     

 
</script>
		<script>
			$(document).ready(()=> {
				const $frmApply = $('#frmRsvtApply');
				
				// 상담분류 하위 선택지 선택
				function setSchdTp(isInit){
					const $target = $('[data-type-filter]');
					const selType = $('[name="schdTpCd"]').val();
					const selTypeDiv = $('[name="schdTpCd"] option:selected').data("schd-div");

					// 예약 구분자 업데이트
					$frmApply.find('[name="schdDiv"]').val(selTypeDiv);

					// dom reset
					$target.hide();
					$target.find('input, select, textarea').attr('disabled',true);
	
					// dom active
					$target.filter('[data-type-filter="' + selType + '"]').show();
					$target.filter('[data-type-filter="' + selType + '"]').find('input, select, textarea').attr('disabled',false);
					
					// 종료시간 셋팅
					let schdEndHh = '10';
					let schdEndMi = '30';
					if (selType!=='01'){ // 교육
						var $csltRqstTpCdDef = $frmApply.find('[name="csltRqstTpCd"] option:eq(0)');
						
						schdEndHh = '10';
						schdEndMi = '00';
						if (isInit!==true) {
							$csltRqstTpCdDef.prop('selected',true);
							$frmApply.find('label[for="csltRqstTpCd"]').text($csltRqstTpCdDef.text());
							$frmApply.find('[name="csltRqstRsnCtn"]').val('');
						}
						setSchdRestTp();
					}
					$frmApply.find('[name="schdEndHh"]').val(schdEndHh);
					$frmApply.find('[name="schdEndMi"]').val(schdEndMi);
					$('#txtEndTime').text(schdEndHh + ':' + schdEndMi);
				}
				
				// 상담신청 하위 선택지 선택
				function setSchdRestTp(){
					const $target = $('[data-rqtype-filter]');
					const selType = $('[name="csltRqstTpCd"]').val();
					
					// reset
					$target.hide();
					$target.find('input, select, textarea').attr('disabled',true);
	
					// active
					$target.filter('[data-rqtype-filter="' + selType + '"]').show();
					$target.filter('[data-rqtype-filter="' + selType + '"]').find('input, select, textarea').attr('disabled',false);
				}
				
				selEvent.init();
				nurseJS.init();
				/*
				resizeContents();
				function resizeContents() {
					$('.wrap_sub').css({
						'min-height': $(window).height() + 'px'
					});
				}
				*/


				// 환아검색
				$('#frmSearchChild').on('submit', function(e){
					e.preventDefault();
					goChildListPage(1);
				});
				
				// 환아 검색결과 클릭
				$(document).on('click', '#divSearchChildResult [name="btnSearchChildSelect"]', function(e){
					const $sel = $(this);
					
					// 선택된 사용자 정보 출력
					$frmApply.find('[data-fill-usr-nm]').text($sel.find('[name="usrNm"]').val());
					$frmApply.find('[data-fill-usr-bday]').html('&nbsp;(' + $sel.find('[name="usrBday"]').val() + ')');
					$frmApply.find('[data-fill-usr-id]').text($sel.find('[name="usrId"]').val());
					$frmApply.find('[data-fill-usr-phn]').text($sel.find('[name="usrPhn"]').val());
					$frmApply.find('[data-fill-hspt-nm]').text($sel.find('[name="hsptNm"]').val());
					
					$('#divSearchChildSelect').show();
					
					// 선택 사용자 정보 form 입력
					$frmApply.find('[name="sichSeq"]').val($sel.find('[name="usrCIdx"]').val());
				});
				
				// 상담분류 선택
				$('[name="schdTpCd"]').on('change', function(){
					setSchdTp(false);
				});

				// 신청사유 선택
				$('[name="csltRqstTpCd"]').on('change', setSchdRestTp);

				
				// 상담신청 등록
				$('[name="btnRsvtApply"]').on('click', function(){
					nurseJS.updateEduSchd($('[name="btnRsvtApply"]'), $frmApply, function(){
						window.location.href = '/nurse/rsvt/usr_rsvt_daily.do?dt=20230905';
					});
				});
				
				// 상담신청 삭제
				$('[name="btnRsvtCancel"]').on('click', function(){
					nurseJS.deleteEduSchd($('[name="btnRsvtCancel"]'), $frmApply, function(){
						window.location.href = '/nurse/rsvt/usr_rsvt_daily.do?dt=20230905';
					});
					openPopup('pop_cclCsl');
				});
				
				// init 
				setSchdTp(true);
				setSchdRestTp();

				// 상담 취소사유 - 2023.08.31
				const $frmCanclCsl = $('#frmCanclCsl');
				function setCClRsnCd() {
					var choose = $frmCanclCsl.find('#cclRsnCd option:selected').attr('value');
					if (choose === '00') { 
						$('#cclRsnDesc').show();
					} else {
						$('#cclRsnDesc').hide();
					}
				}
				$frmCanclCsl.find('#cclRsnCd').on('change', setCClRsnCd);

			});
			
			function goChildListPage(pageNo){
				const $form = $('#frmSearchChild');
				/*
				if (!$('#frmSearchChild').find('[name="searchKeyword"]').val()) {
					alert('이름은 필수검색어 입니다.');
					$('#frmSearchChild').find('[name="searchKeyword"]').focus();
					return;
				}
				const bday = $('#frmSearchChild').find('[name="searchChBday"]').val();
				if (bday && bday.length < 4) {
					alert('생년월일은 4글자 이상 입력해주세요.');
					$('#frmSearchChild').find('[name="searchChBday"]').focus();
					return;
				}
				*/
				let searchWord = '';
				$form.find('[data-search-field]').each(function(){
					searchWord = searchWord + '' + $(this).val();
				});
				if (!searchWord) {
					alert('검색 항목을 한가지 이상 입력해주세요.');
					return;
				}

				$form.find('[name="pageIndex"]').val(pageNo);
				$.ajax({
					type: "POST",
					data: $form.serialize(),
					url : '/nurse/rsvt/ajax_usr_rsvt_child_list.do',
					dataType : "html",
					success: function(res){
						$('#divSearchChildResult').html(res);
					},
					error: function(xhr, option, error){
						console.log('상담일정관리 : 환아검색 >> error ', xhr, option, error);
					}
				});
			}
		</script>

	</head>
	
	 <body>
		<div class="wrap wrap_sub wrap_sub02">

      <!-- 팝업 추가 -->
      <div class="popup">
				<div class="inner_pop">
					<button type="button" onclick="javascript:;" class="btn_close close_pop"></button>
          
          <!-- 상담취소사유 팝업  - 2023.08.31 -->
					<form id="frmCanclCsl" name="frmCanclCsl">
						<div class="pop_content impossible_pop pop_cclCsl">
							<h3>상담을 취소하시겠습니까?</h3>
							<ul>
								<li class="alignLeft">
									<span>상담</span>
									2022-12-14 09:30 ~ 10:00
								</li>
							</ul>
							<div class="impos_action">
								<select name="cclRsnCd" id="cclRsnCd">
									<option value="" selected="">취소사유를 선택하세요</option>
									<option value="01">다른날짜/시간으로 변경</option>
									<option value="02">담당간호사 변경</option>
									<option value="03">유트로핀이 아닌 다른 제품으로 변경</option>
									<option value="04">이미 교육/상담 진행함</option>
									<option value="00">기타 (직접입력)</option>
								</select>
								<textarea name="cclRsnDesc" id="cclRsnDesc" placeholder="직접입력"></textarea>
							</div>
							<button type="button" class="cancel close_pop">닫기</button>
							<button type="button" name="" class="save">확인</button>
						</div>
					</form>
          
        </div>
      </div>


			<!--// top -->
			<div class="sub_top">
				

				<div class="nav">
					<div class="nav_inner">
						<h2 class="title">상담관리</h2>
						<div class="back">
							<!-- 
							<a href="javascript:history.back();" title="뒤로가기"><img src="/resource/assets/web/nurse/images/common/back.png" alt="뒤로가기"></a>
							-->
							<a href="/nurse/rsvt/usr_rsvt_daily.do?dt=202309050930" title="뒤로가기"><img src="/resource/assets/web/nurse/images/common/back.png" alt="뒤로가기"></a>
						</div>
					</div>
				</div>
				
					
						<nav class="sub_nav">
							<a href="/nurse/counseling/list.do" title="온라인문의"	>온라인문의</a>
							<a href="/nurse/rsvt/usr_rsvt_monthly.do" title="상담일정관리"  class="active">상담일정관리</a>
							<a href="/nurse/rsvt/nrs_schd_monthly.do" title="상담가능일정등록" >상담가능일정관리</a>
						</nav>
					
					
				
			</div>
			<!-- top //-->
	
			<!--// content --> 
			<div class="content con_sub happycall">
				<div class="con_box con_head">
					<div class="con_inner03">
						<h3 class="date_tit">
							2023년 09월 05일 (화)
						</h3>
						<p>상담신청</p>
					</div>
				</div>
				
				
				
				<!-- 입력 영역 -->
				<form id="frmRsvtApply" method="post">
					<input type="hidden" name="schdSeq" value="7581">
					<input type="hidden" name="sichSeq" value="43233">
					<input type="hidden" name="schdDt" value="20230905">
					<input type="hidden" name="schdStHh" value="09">
					<input type="hidden" name="schdStMi" value="30">
					<input type="hidden" name="schdEndHh" value="10">
					<input type="hidden" name="schdEndMi" value="00">
					<input type="hidden" name="schdDiv">
					
					<div class="con_box mt8" id="divSearchChildSelect" >
						<div class="info01">
							<h4 class="ffEB">신청대상</h4>
							<ul>
								<li class="name" data-fill-usr-nm><!-- 환아 성명 출력 -->박포엠</li>
								<li class="date" data-fill-usr-bday><!-- 환아 생년월일 출력 -->
									
										&nbsp;(2023.07.20)
									
								</li>
								<li class="id" data-fill-usr-id><!-- 보호자 아이디 출력 -->4mtest1</li>
								<li class="phone" data-fill-usr-phn><!-- 연락처 -->
									
									<a href="tel:010-3186-7221" title="전화걸기">010-3186-7221</a>
								</li>
								<li class="hospital" data-fill-hspt-nm><!-- 병원명 -->재단법인아산사회복지재단서울아산병원</li>
							</ul>
						</div>
					</div>
		
					<div class="con_box">
						<div class="form_box">
							<h4 class="ffEB">신청내용</h4>
							<div class="con_form">
								<div class="select_row">
									<label for="schdTpCd">상담</label>
									<select name="schdTpCd" id="schdTpCd">
										<option value="" data-schd-div="">상담분류</option>
										
											
												<option value="01" data-schd-div="ED" >교육</option>
											
										
											
												<option value="02" data-schd-div="ED"  selected>상담</option>
											
										
										
										
									</select>
								</div>
							</div>
							<div class="con_form" data-type-filter="02" style="display:none">
								<div class="select_row">
									<label for="csltRqstTpCd">제품변경 교육 요청</label>
									<select name="csltRqstTpCd" id="csltRqstTpCd" disabled>
										<option value="">신청사유</option>
										
											<option value="01"  selected>제품변경 교육 요청</option>
										
											<option value="02" >주사방법 재교육 요청</option>
										
											<option value="99" >기타</option>
										
									</select>
								</div>
							</div>
							<div class="con_form" data-type-filter="02" data-rqtype-filter="99" style="display:none">
								<div class="area_box">
									<textarea name="csltRqstRsnCtn" placeholder="신청사유 기타 상세" disabled></textarea>
								</div>
							</div>
							<div class="con_form">
								<div class="area_box">
									<textarea name="schdDesc" placeholder="메모">jj</textarea>
								</div>
							</div>
						</div>
					</div>
		
					<div class="con_box">
						<div class="con_inner03">
							<div class="info02">
								<h4 class="ffEB">신청일시</h4>
								<span>
									2023년 09월 05일 09:30
									~
									<span id="txtEndTime">
										
									</span>
								</span>
							</div>
						</div>
					</div>
				</form>
			</div>
			<div class="btn_box btn_box03 btn_bottom">
				<div class="inner">
          <div class="btn_white"><a href="/nurse/rsvt/usr_rsvt_daily.do?dt=20230905">뒤로가기</a></div>
					<div class="btn_gray"><button type="button" name="btnRsvtCancel">신청취소</button></div>
					<div class="btn_orange"><button type="button" name="btnRsvtApply">수정</button></div>
				</div>
			</div>
			
	
			<!-- content //-->
		</div>
	</body>
</html>
